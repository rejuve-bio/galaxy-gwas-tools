<tool id="gcta_cojo_analysis" name="GCTA-COJO Analysis" version="1.0.6">
    <description>Identifies independent GWAS signals</description>
    <requirements>
        <requirement type="package" version="1.94.1">gcta</requirement>
        <requirement type="package" version="2.1.0">pandas</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        # Create a directory for the reference files and link the inputs into it
        mkdir plink_ref &&
        ln -s '$plink_bed' 'plink_ref/${population}.bed' &&
        ln -s '$plink_bim' 'plink_ref/${population}.bim' &&
        ln -s '$plink_fam' 'plink_ref/${population}.fam' &&

        python3 "$__tool_directory__/gcta_cojo_wrapper.py"
            --sumstats "$sumstats_file"
            --plink_ref_dir "plink_ref"
            --maf $maf
            --population "$population"
            --output "$output_file"
            --script_dir "$__tool_directory__"
    ]]></command>
    <inputs>
        <param name="sumstats_file" type="data" format="tsv" label="Filtered Summary Statistics" help="Output from the 'Filter by P-value' tool."/>

        <!-- Aligned formats -->
        <param name="plink_bed" type="data" format="binary" label="PLINK BED file"/>
        <param name="plink_bim" type="data" format="tabular" label="PLINK BIM file"/>
        <param name="plink_fam" type="data" format="tabular" label="PLINK FAM file"/>

        <param name="maf" type="float" value="0.01" label="Minor Allele Frequency (MAF)" />
        <param name="population" type="text" value="EUR" label="Population Prefix" help="The prefix of your PLINK files (e.g., EUR for EUR.bed). This will be used to name the files for GCTA."/>
    </inputs>
    <outputs>
        <data name="output_file" format="tsv" label="${tool.name} on ${on_string}"/>
    </outputs>
    <help><![CDATA[
**What it does**
This tool performs a conditional and joint analysis (COJO) using GCTA to identify genetic variants that are independently associated with a trait.
    ]]></help>
</tool>