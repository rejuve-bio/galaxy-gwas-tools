<tool id="magma_format_gwas_auto" name="MAGMA: Format GWAS (Auto)" version="1.1">
    <description>Automatically format GWAS summary statistics for MAGMA</description>

    <command>
        python3 $__tool_directory__/format_gwas.py
        --gwas $gwas
        --out_prefix $out_prefix
    </command>

    <inputs>
        <param name="gwas"
               type="data"
               format="txt,txt.gz"
               label="GWAS summary statistics file"
               help="Must contain SNP, CHR, POS and P or -log10(P) columns"/>
        
        <param name="out_prefix"
               type="text"
               value="magma_input"
               label="Output file prefix"/>
    </inputs>

    <outputs>
        <data name="snp_loc"
              format="txt"
              from_work_dir="${out_prefix}.snp.chr.pos.txt"
              label="MAGMA SNP location file"/>

        <data name="pval"
              format="txt"
              from_work_dir="${out_prefix}.pval.txt"
              label="MAGMA SNP p-values"/>

        <data name="meta"
              format="txt"
              from_work_dir="${out_prefix}.meta.txt"
              label="Detected GWAS metadata"/>
    </outputs>

    <help>
This tool automatically:
- Detects SNP / CHR / POS / P columns
- Converts -log10(P) to P if needed
- Estimates sample size (N)
Outputs files ready for MAGMA annotation and gene analysis.
    </help>
</tool>
