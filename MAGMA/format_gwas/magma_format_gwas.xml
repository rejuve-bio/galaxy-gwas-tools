<tool id="magma_format_gwas" name="MAGMA Format GWAS" version="1.0.0">
  <description>Prepare SNP location and p-value files from GWAS summary stats</description>
  <requirements>
    <requirement type="package" version="3.9">python</requirement>
    <requirement type="package" version="2.2.2">pandas</requirement>
  </requirements>
<command interpreter="bash">magma_format_gwas.sh '$gwas_file' '$chrom_selection.chromosome' '$chrom_selection.specific_chr'</command>
  <inputs>
    <param name="gwas_file" type="data" format="tabular.gz,txt.gz" label="GWAS Summary Statistics File (.gz)" />
    <conditional name="chrom_selection">
      <param name="chromosome" type="select" label="Process Whole Genome or Specific Chromosome?">
        <option value="all" selected="true">Whole Genome (All Chromosomes)</option>
        <option value="specific">Specific Chromosome</option>
      </param>
      <when value="all" />
      <when value="specific">
        <param name="specific_chr" type="integer" value="3" min="1" max="23" label="Specific Chromosome Number (1-22 or 23 for X)" />
      </when>
    </conditional>
  </inputs>
  <outputs>
    <collection name="outputs" type="list" label="Formatted Files">
      <data name="snp_loc" format="txt" label="SNP Location File" from_work_dir="snp_loc.txt" />
      <data name="pval" format="txt" label="P-Value File" from_work_dir="pval.txt" />
    </collection>
  </outputs>
  <citations>
    <citation type="doi">10.1371/journal.pcbi.1004219</citation> <!-- MAGMA paper -->
  </citations>
  <help><![CDATA[
**What it does**: Extracts SNP locations (rsID, CHR, POS) and p-values from BBJ-style GWAS summary stats. Defaults to whole genome; option for specific chromosome for testing.
Assumes columns: 2=rsID, 3=CHR, 4=POS, 15=P (skip header).
  ]]></help>
</tool>