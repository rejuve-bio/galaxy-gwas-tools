<tool id="pysusie_finemap" name="PySuSiE Fine-Mapping" version="1.0.1">
    <description>Fine-mapping GWAS summary statistics with PySuSiE</description>

    <requirements>
        <requirement type="python_module" version="0.2.1">pysusie</requirement>
        <requirement type="python_module" version="2.1.0">pandas</requirement>
        <requirement type="python_module" version="1.26.0">numpy</requirement>
    </requirements>

    <command detect_errors="exit_code"><![CDATA[
        python3 '$__tool_directory__/run_pysusie.py'
            --sumstats '$sumstats_file'
            --ld_matrix '$ld_matrix_file'
            --snp_list '$snp_list_file'
            --n $sample_size
            --output_creds '$output_creds'
            --output_pips '$output_pips'
    ]]></command>

    <inputs>
        <param name="sumstats_file" type="data" format="tabular,txt,txt.gz" label="Full Filtered Summary Statistics"/>
        <param name="ld_matrix_file" type="data" format="tabular,txt,txt.gz" label="LD Matrix File"/>
        <param name="snp_list_file" type="data" format="tabular,txt,txt.gz" label="SNP List / PLINK Log"/>
        <param name="sample_size" type="integer" label="GWAS Sample Size (N)" value="100000"/>
    </inputs>

    <outputs>
        <data name="output_creds" format="tabular" label="PySuSiE Credible Sets"/>
        <data name="output_pips" format="tabular" label="PySuSiE PIPs"/>
    </outputs>

    <help><![CDATA[
This tool runs the PySuSiE fine-mapping method on GWAS summary statistics.

**Inputs:**
- GWAS summary statistics file (`.txt`, `.tabular`, or gzipped `.txt.gz`)
- LD matrix file (`.txt`, `.tabular`, or gzipped `.txt.gz`)
- SNP list file
- Sample size (N)

**Outputs:**
- Credible set file
- Posterior inclusion probabilities (PIPs)

The dependencies are installed automatically from PyPI.

    ]]></help>
</tool>
